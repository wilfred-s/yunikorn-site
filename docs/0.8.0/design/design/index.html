<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<title data-react-helmet="true">Design | Apache YuniKorn (Incubating)</title><meta data-react-helmet="true" name="docsearch:version" content="0.8.0"><meta data-react-helmet="true" property="og:image" content="http://yunikorn.apache.org/img/logo/yunikorn-logo-main.png"><meta data-react-helmet="true" property="twitter:image" content="http://yunikorn.apache.org/img/logo/yunikorn-logo-main.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Apache YuniKorn (Incubating)"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Design | Apache YuniKorn (Incubating)"><meta data-react-helmet="true" name="description" content="&lt;!--"><meta data-react-helmet="true" property="og:description" content="&lt;!--"><meta data-react-helmet="true" property="og:url" content="http://yunikorn.apache.org/docs/0.8.0/design/design"><link data-react-helmet="true" rel="shortcut icon" href="/img/yunikorn.ico"><link data-react-helmet="true" rel="canonical" href="http://yunikorn.apache.org/docs/0.8.0/design/design"><link rel="stylesheet" href="/styles.3300edef.css">
<link rel="preload" href="/styles.42927ee7.js" as="script">
<link rel="preload" href="/runtime~main.eb375781.js" as="script">
<link rel="preload" href="/main.6222ead5.js" as="script">
<link rel="preload" href="/1.f2f38753.js" as="script">
<link rel="preload" href="/2.05510059.js" as="script">
<link rel="preload" href="/3.a37a1908.js" as="script">
<link rel="preload" href="/1be78505.e1f44db4.js" as="script">
<link rel="preload" href="/146.37105179.js" as="script">
<link rel="preload" href="/c95b781b.a72c9bda.js" as="script">
<link rel="preload" href="/17896441.6af894f7.js" as="script">
<link rel="preload" href="/da3e9658.ca1ccf7e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/yunikorn.ico" alt="YuniKorn Site Logo"><strong class="navbar__title">Apache YuniKorn</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Quick Start</a><a class="navbar__item navbar__link" href="/community/roadmap">Roadmap</a><a class="navbar__item navbar__link" href="/community/download">Download</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" position="left" href="/community/get_involved">Get Involved</a></li><li><a class="dropdown__link" position="left" href="/community/how_to_contribute">How to Contribute</a></li><li><a class="dropdown__link" position="left" href="/community/coding_guidelines">Coding Guidelines</a></li><li><a class="dropdown__link" position="left" href="/community/reporting_issues">Reporting Issues</a></li><li><a class="dropdown__link" position="left" href="/community/sessions">Sessions and Demos</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link" position="left">Apache Software Foundation</a></li><li><a href="https://incubator.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link" position="left">Apache Incubator</a></li><li><a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener noreferrer" class="dropdown__link" position="left">Apache License</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link" position="left">Sponsorship</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" position="left" href="/docs/next/">Master</a></li><li><a class="dropdown__link" position="left" href="/docs/">0.10.0</a></li><li><a class="dropdown__link" position="left" href="/docs/0.9.0/">0.9.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" position="left" href="/docs/0.8.0/">0.8.0</a></li></ul></div><a href="https://github.com/apache/incubator-yunikorn-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/yunikorn.ico" alt="YuniKorn Site Logo"><strong class="navbar__title">Apache YuniKorn</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Quick Start</a></li><li class="menu__list-item"><a class="menu__link" href="/community/roadmap">Roadmap</a></li><li class="menu__list-item"><a class="menu__link" href="/community/download">Download</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist">Community</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/community/get_involved">Get Involved</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/community/how_to_contribute">How to Contribute</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/community/coding_guidelines">Coding Guidelines</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/community/reporting_issues">Reporting Issues</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/community/sessions">Sessions and Demos</a></li></ul></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist">Apache</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="menu__link" position="left">Apache Software Foundation</a></li><li class="menu__list-item"><a href="https://incubator.apache.org/" target="_blank" rel="noopener noreferrer" class="menu__link" position="left">Apache Incubator</a></li><li class="menu__list-item"><a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener noreferrer" class="menu__link" position="left">Apache License</a></li><li class="menu__list-item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="menu__link" position="left">Sponsorship</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--sublist navbar__link--active" href="/docs">Docs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/next/">Master</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/">0.10.0</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/0.9.0/">0.9.0</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" position="left" href="/docs/0.8.0/">0.8.0</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/apache/incubator-yunikorn-core" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Get Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/release-announce/0.8.0/">Release Notes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/">User Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/get_started/developer_guide">Developer Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/setup/build_local">Build Local</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/setup/configure_scheduler">Configure Scheduler</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/setup/deployment">Deployment Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/setup/env_setup">Environment Setup</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/configuration/queue_config">Queue Config</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/configuration/placement_rules">Placement Rules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/configuration/acls">Acls</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Performance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/performance/evaluate_perf_function_with_kubemark">Perf With Kubemark</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/performance/metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.8.0/performance/profiling">Profiling</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Design</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/0.8.0/design/design">Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.8.0/design/cross_queue_preemption">Cross Queue Preemption</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.8.0/design/namespace_resource_quota">Namespace Resource Quota</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.8.0/design/pluggable_app_management">Pluggable App Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.8.0/design/resilience">Resilience</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.8.0/design/scheduler_configuration">Scheduler Configuration</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for Apache YuniKorn (Incubating) <strong>0.8.0</strong>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/docs/">latest version</a></strong> (0.10.0).</div></div><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: 0.8.0</span></div><header><h1 class="docTitle_1Lrw">Design</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="design-of-yunikorn-scheduler"></a>Design of YuniKorn scheduler<a aria-hidden="true" tabindex="-1" class="hash-link" href="#design-of-yunikorn-scheduler" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="overall"></a>Overall<a aria-hidden="true" tabindex="-1" class="hash-link" href="#overall" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="architecture"></a>Architecture<a aria-hidden="true" tabindex="-1" class="hash-link" href="#architecture" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="components"></a>Components:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#components" title="Direct link to heading">#</a></h3><p><strong>Scheduler API Server</strong>:</p><p>Responsible for communication between RM and Scheduler, which implements scheduler-interface GRPC protocol, or just APIs. (For intra-process communication w/o Serde).</p><p><strong>Scheduler Cache</strong>:</p><p>Caches all data related to scheduler state, such as used resources of each queues, nodes, allocations. Relationship between allocations and nodes, etc.
Should not include temporary data helps with scheduler. For example to-be-preempted allocation candidates. Fair share resource of queues, etc.</p><p><strong>Scheduler Cache Event Handler</strong>:</p><p>Handles all events which needs to update scheduler internal state. So all the write operations will be carefully handled.</p><p><strong>Admin Service</strong></p><p>Handles request from Admin, which can also load configurations from storage and update scheduler policies.</p><p><strong>Scheduler and Preemptor</strong></p><p>Handles Scheduler&#x27;s internal state. (Which is not belong to scheduelr cache), such as internal reservations, etc. Scheduler and preemptor will work together, make scheduling or preemption decisions.</p><p>All allocate/preempt request will be handled by event handler.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      GRPC Protocol</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+---------------------------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     +--------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     |Scheduler API Server|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> +-------------+     +---------+----------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> |AdminService |               |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> +-------------+               |Write Ops                    +----------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> +-------------+               V                            ++Scheduler       |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> |Configurator |      +-------------------+  Allocate       ||   And          |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> +-------------+      |Cache Event Handler+&lt;-----------------|                |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         +----------&gt; +-------------------+  Preempt        ++Preemptor       |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          Update Cfg   Handled by policies                   +----------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                               +  (Stateless)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        +------v--------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        |Scheduler Cache|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        +---------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                +---------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                |--------+ +------+ +----------+ +----------+ |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ||Node   | |Queue | |Allocation| |Requests  | |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                |--------+ +------+ +----------+ +----------+ |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                +---------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="implementation"></a>Implementation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#implementation" title="Direct link to heading">#</a></h2><p><strong>Scheduler needs to do following responsibilities</strong></p><ul><li>According to resource usages between queues, sort queues, applications, and figure out order of application allocation. (This will be used by preemption as well).</li><li>It is possible that we cannot satisfy some of the allocation request, we need to skip them and find next request.</li><li>It is possible that some allocation request cannot be satisfied because of resource fragmentation. We need to reserve room for such requests.</li><li>Different nodes may belong to different disjoint partitions, we can make independent scheduler runs</li><li>Locality is still important for many scenarios, especially for on-prem cases.</li><li>Be able to config and change ordering policies for apps, queues.</li><li>Application can choose their own way to manage sort of nodes.</li></ul><p><strong>Preemption:</strong></p><ul><li>It is important to know &quot;who wanna the resource&quot;, so we can do preemption based on allocation orders.</li><li>When do preemption, it is also efficient to trigger allocation op. Think about how to do it.</li><li>Preemption needs to take care about queue resource balancing.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="configurations--semantics"></a>Configurations &amp; Semantics<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configurations--semantics" title="Direct link to heading">#</a></h2><p>Example of configuration:</p><ul><li><p>Partition is name space.</p></li><li><p>Same queues can under different partitions, but enforced to have same hierarchy.</p><p>  Good:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> partition=x    partition=y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     a           a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   /   \        / \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  b     c      b   c</span></div></div></div></div></div><p>  Good (c in partition y acl=&quot;&quot;):</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> partition=x    partition=y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     a           a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   /   \        /</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  b     c      b</span></div></div></div></div></div><p>  Bad (c in different hierarchy)</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> partition=x    partition=y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     a           a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   /   \        /  \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  b     c      b    d</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              /</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             c</span></div></div></div></div></div><p>  Bad (Duplicated c)</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> partition=x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   /   \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  b     c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> /</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div></li><li><p>Different hierarchies can be added</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-scheduler-conf.yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">partitions:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - name:  default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    queues:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        root:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          configs:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            acls:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          childrens:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            - a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            - b</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            - c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            - ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        a:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          configs:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            acls:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            capacity: (capacity is not allowed to set for root)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            max-capacity: ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      mapping-policies:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - name: partition_a:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    queues:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        root:...</span></div></div></div></div></div></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="flow-of-events"></a>Flow of events<a aria-hidden="true" tabindex="-1" class="hash-link" href="#flow-of-events" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Job Add:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM -&gt; Cache -&gt; Scheduler (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Job Remove:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-----------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM -&gt; Scheduler -&gt; Cache (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Released allocations: (Same as normal release) (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Note: Make sure remove from scheduler first to avoid new allocated created. </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scheduling Request Add:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-----------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM -&gt; Cache -&gt; Scheduler (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Note: Will check if requested job exists, queue exists, etc.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">When any request invalid:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Cache -&gt; RM (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Scheduler -&gt; RM (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scheduling Request remove:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">------------------------- </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM -&gt; Scheduler -&gt; Cache (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Note: Make sure removed from scheduler first to avoid new container allocated</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Allocation remove (Preemption) </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-----------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scheduler -&gt; Cache -&gt; RM (TODO)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              (confirmation)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Allocation remove (RM voluntarilly ask)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">---------------------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM -&gt; Scheduler -&gt; Cache -&gt; RM. (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      (confirmation)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Node Add: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">---------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM -&gt; Cache -&gt; Scheduler (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Note: Inside Cache, update allocated resources.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Error handling: Reject Node to RM (Implemented)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Node Remove: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Implemented in cache side</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM -&gt; Scheduler -&gt; Cache (TODO)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Allocation Proposal:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scheduler -&gt; Cache -&gt; RM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">When rejected/accepted:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Cache -&gt; Scheduler</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Initial: (TODO)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">1. Admin configured partitions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2. Cache initializes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">3. Scheduler copies configurations</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Relations between Entities </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">1. RM includes one or multiple:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   - Partitions </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   - Jobs</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   - Nodes </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   - Queues</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2. One queue: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   - Under one partition</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   - Under one RM.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">3. One job: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   - Under one queue (Job with same name can under different partitions)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   - Under one partition</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM registration: (TODO)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">----------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">1. RM send registration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2. If RM already registered, remove old one, including everything belong to RM.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RM termination (TODO) </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Just remove the old one.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Update of queues (TODO) </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Admin Service -&gt; Cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">About partition (TODO) </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-----------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Internal partition need to be normalized, for example, RM specify node with partition = xyz. </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scheduler internally need to normalize it to &lt;rm-id&gt;_xyz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">This need to be done by RMProxy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/0.8.0/performance/profiling"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Profiling</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/0.8.0/design/cross_queue_preemption"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cross Queue Preemption Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overall" class="table-of-contents__link">Overall</a></li><li><a href="#architecture" class="table-of-contents__link">Architecture</a><ul><li><a href="#components" class="table-of-contents__link">Components:</a></li></ul></li><li><a href="#implementation" class="table-of-contents__link">Implementation</a></li><li><a href="#configurations--semantics" class="table-of-contents__link">Configurations &amp; Semantics</a></li><li><a href="#flow-of-events" class="table-of-contents__link">Flow of events</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Blog</h4><ul class="footer__items"><li class="footer__item"><a href="https://blog.cloudera.com/yunikorn-a-universal-resources-scheduler/" target="_blank" rel="noopener noreferrer" class="footer__link-item">What&#x27;s YuniKorn?</a></li><li class="footer__item"><a href="https://blog.cloudera.com/apache-yunikorn-incubating-0-8-release-whats-new-and-upcoming/" target="_blank" rel="noopener noreferrer" class="footer__link-item">What&#x27;s new in YuniKorn 0.8.0?</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Github</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/incubator-yunikorn-core/" target="_blank" rel="noopener noreferrer" class="footer__link-item">scheduler-core</a></li><li class="footer__item"><a href="https://github.com/apache/incubator-yunikorn-k8shim" target="_blank" rel="noopener noreferrer" class="footer__link-item">kubernetes-shim</a></li><li class="footer__item"><a href="https://github.com/apache/incubator-yunikorn-scheduler-interface" target="_blank" rel="noopener noreferrer" class="footer__link-item">scheduler-interface</a></li><li class="footer__item"><a href="https://github.com/apache/incubator-yunikorn-web" target="_blank" rel="noopener noreferrer" class="footer__link-item">scheduler-web</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/community/get_involved">Get Involved</a></li><li class="footer__item"><a href="http://people.apache.org/phonebook.html?podling=yunikorn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Roster</a></li><li class="footer__item"><a href="https://issues.apache.org/jira/projects/YUNIKORN/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://incubator.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1zJy"><img class="footer__logo" alt="Apache Incubator Logo" src="https://incubator.apache.org/images/incubator_feather_egg_logo.png"></a></div><div>
Copyright Â© 2021 <a href="http://www.apache.org/">The Apache Software Foundation</a>. Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>. <br>
<div style="padding:20px; margin: 10px; color: #4d4d4d;">
  Apache YuniKorn is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the name of Apache TLP sponsor.
  Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications,
  and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily
  a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
</div>
</div></div></div></footer></div>
<script src="/styles.42927ee7.js"></script>
<script src="/runtime~main.eb375781.js"></script>
<script src="/main.6222ead5.js"></script>
<script src="/1.f2f38753.js"></script>
<script src="/2.05510059.js"></script>
<script src="/3.a37a1908.js"></script>
<script src="/1be78505.e1f44db4.js"></script>
<script src="/146.37105179.js"></script>
<script src="/c95b781b.a72c9bda.js"></script>
<script src="/17896441.6af894f7.js"></script>
<script src="/da3e9658.ca1ccf7e.js"></script>
</body>
</html>